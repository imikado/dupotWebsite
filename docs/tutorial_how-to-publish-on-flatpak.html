<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dupot.org: Arr&ecirc;ter de tourner autour...</title>

  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZVG5R211FM"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'G-ZVG5R211FM');
  </script>
  <style>
    .logo {
      background: url('css/images/logo.png') no-repeat 0px center;
      padding-left: 55px;
    }


    #popup {
      position: absolute;
      background: #FFF;
      border: 3px solid #444;
      top: 10px;
      left: 40px;
    }

    #popup a {
      color: white;
    }

    #popup p {
      background: #444;
      margin: 0px;
      text-align: right;
      padding-right: 3px;
    }

    .main {
      min-height: 500px;
    }

    .github {
      background: url("css/images/GitHub-Mark-32px.png") no-repeat center;
      padding: 0px 24px;
    }

    .twitter {
      background: url("css/images/Twitter-social-icons-circle-blue.png") no-repeat center;
      padding: 0px 24px;
    }

    .twitter-repo {
      background: url("css/images/Twitter-social-icons-circle-white.png") no-repeat 10px;
      padding-left: 50px;
    }

    .github-repo {
      background: url("css/images/GitHub-Mark-32px.png") no-repeat 10px #0277bd;
      padding-left: 50px;
    }

    .itchio {
      background: url("css/images/itchio.png") no-repeat center;
      padding: 0px 24px;
    }

    .buttons {
      text-align: center;
    }

    .is-justified {
      text-align: justify;
    }

    .icon-td {
      width: 80px;
    }

    .content-centered {
      text-align: center;
    }

    body {
      background: #fff3e0;
    }

    h1,
    h2 {
      color: #e65100;
    }
  </style>
</head>

<body>

  <nav>
    <div class="nav-wrapper white logo">
        <a href="#" class="brand-logo">&nbsp;</a>


        <ul id="nav-mobile" class="sidenav" style="transform: translateX(-105%);">

                            <li ><a href="games.html">Jeux</a></li>
                            <li ><a href="desktop.html">Logiciels</a></li>
                            <li ><a href="tutorials.html">Tutos</a></li>
                            <li ><a href="project_article.html">Ressources d'articles</a></li>
                            <li ><a href="resources.html">Librairies & co</a></li>
                            <li ><a href="about.html">A propos</a></li>
                            <li ><a href="https://github.com/imikado">Github</a></li>
                            <li ><a href="https://dupot-org.itch.io/">Itchio</a></li>
            

        </ul>


        <ul id="nav-mobile" class="right hide-on-med-and-down">
            
                <li >
                                            <a class="orange-text text-darken-4" href="games.html">Jeux</a>

                                    </li>

            
                <li >
                                            <a class="orange-text text-darken-4" href="desktop.html">Logiciels</a>

                                    </li>

            
                <li >
                                            <a class="orange-text text-darken-4" href="tutorials.html">Tutos</a>

                                    </li>

            
                <li >
                                            <a class="orange-text text-darken-4" href="project_article.html">Ressources d'articles</a>

                                    </li>

            
                <li >
                                            <a class="orange-text text-darken-4" href="resources.html">Librairies & co</a>

                                    </li>

            
                <li >
                                            <a class="orange-text text-darken-4" href="about.html">A propos</a>

                                    </li>

            
                <li >
                                            <a class="github" target="_blank" href="https://github.com/imikado">&nbsp;</a>
                                    </li>

            
                <li >
                                            <a class="itchio" target="_blank" href="https://dupot-org.itch.io/">&nbsp;</a>
                                    </li>

            
        </ul>

        <a style="float:right" href="#" data-target="nav-mobile" class="sidenav-trigger"><i class="material-icons orange-text">menu</i></a>



    </div>
</nav>
  <div class="header">&nbsp;</div>

  <div class="main">
    <div class="container">


      <style>
    pre {
        background-color: #eee;
    }
</style>
<div class="content">

    <div class="row">
        <div class="col">
            <div class="card ">

                <div class="card-content">


                    <h2>Publier un jeu Godot sur Flathub</h2>
<p>Cet article vous montre comment publier un jeu Godot sur Flathub, je n'aborde pas ici d'autre moteur de jeu,  mais ce tuto peut vous aider à comprendre la mécanique utilisée.</p>
<h4>Créer un compte github</h4>
<p>Vous allez avoir besoin d'un compte github dans cet article, si ce n'est pas déjà fait, je vous invite à en créer un sur <a href="https://github.com">https://github.com</a></p>
<p>J'y ferais réference dans cet article avec le nom &quot;votre_identifiant_github&quot;</p>
<h4>Créer un projet pour votre jeu</h4>
<p>Sur github, créez un projet pour votre jeu, vous y stoquerez la version compilé de celui-ci pour linux</p>
<p>Une fois ce dépot créé, nous l'appelrons ici github.com/votre_identifiant_github/votre_jeu</p>
<p>Sur votre ordinateur</p>
<pre><code>mkdir github
cd github
git clone github.com/votre_identifiant_github/votre_jeu.git
cd votre_jeu</code></pre>
<p>nous allons ici créer l'arborescence suivante, histoire d'organiser le tout proprement</p>
<pre><code>mkdir -p export/linux/flatpak
mkdir -p export/linux/screenshots
</code></pre>
<h4>Exporter votre jeu vers Linux</h4>
<p>Dans Godot, export</p>
<ul>
<li>Linux / X11</li>
</ul>
<p>et définissez comme destination le répertoire export/linux que l'on vient de créer </p>
<p>Vous pouvez en profitez pour faire quelques screenshots et les déposer dans export/linux/screenshots</p>
<h4>Finissons le setup sur notre dépot Github</h4>
<p>Nous revenons sur notre dépot github du jeu</p>
<p>Vous avez donc dans export/linux 2 fichiers: votre_jeu.x86_64 et votre_jeu.pck</p>
<p>Il nous faut créer 3 autres fichiers:</p>
<pre><code>cd votre_jeu
touch export/linux/flatpack/512x512.png
touch export/linux/flatpack/com.domain.votre_jeu.desktop
touch export/linux/flatpack/com.domain.votre_jeu.appdata.xml</code></pre>
<p>Pour l'image 512x512, je vous laisse utiliser vos outils préféré (Gimp,Krita,Inkscape...) pour faire l'icone le plus sympa</p>
<p>Contenu de votre_jeu.desktop</p>
<pre><code>[Desktop Entry]
Name=Votre jeu
Exec=votre_jeu.x86_64
Type=Application
Icon=com.domain.votre_jeu
Categories=Game</code></pre>
<p>Contenu de votre_jeu.appdata.xml</p>
<pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;component type="desktop"&gt;
  &lt;id&gt;com.domain.votre_jeu&lt;/id&gt;
  &lt;metadata_license&gt;CC0-1.0&lt;/metadata_license&gt;
  &lt;project_license&gt;Votre_licence&lt;/project_license&gt;
  &lt;name&gt;Votre jeu&lt;/name&gt;
  &lt;summary&gt;Résume court de votre jeu&lt;/summary&gt;
  &lt;description&gt;
    &lt;p&gt;
  Description de votre jeu
    &lt;/p&gt;
  &lt;/description&gt;

   &lt;screenshots&gt;
    &lt;screenshot type="default"&gt;
      &lt;image&gt;https://raw.githubusercontent.com/votre_identifiant_github/votre_jeu/identifiant_commit/export/linux/screenshots/le_nom_de_votre_screenshot.png&lt;/image&gt;
    &lt;/screenshot&gt;

&lt;url type="homepage"&gt;https://votre.site.web&lt;/url&gt;
  &lt;url type="vcs-browser"&gt;https://github.com/votre_identifiant_github/votre_jeu/&lt;/url&gt;
  &lt;update_contact&gt;votre@email.com&lt;/update_contact&gt;
  &lt;content_rating type="oars-1.1"/&gt;
  &lt;releases&gt;

    &lt;release date="2023-10-03" version="1.0"/&gt;
  &lt;/releases&gt;

&lt;/component&gt;</code></pre>
<p>Faites un commit + push, récupéré le commit id pour venir le remplacer dans l'url des screenshots</p>
<p>Faites un second commit + push, et cette fois copier le commit ID, nous allons en avoir besoin</p>
<p>nous l'appelerons identifiant_du_dernier_commit</p>
<h4>Forker le dépot flathub</h4>
<p>Sur votre ordinateur, </p>
<pre><code>mkdir github
cd github
git clone --branch=new-pr git@github.com:votre_identifiant_github/flathub.git</code></pre>
<p>Vous avez forké le dépot flathub sur votre compte github, allez dedans pour créer une branche pour votre jeu</p>
<pre><code>cd flathub
git checkout -b identifiant_de_votre_jeu</code></pre>
<p>Par convention, on nomme les jeux avec un id qui ressemble à un nom de domaine inversé, par exemple j'ai ici un nom de domaine dupot.org
et je nomme mes jeux: org.dupot.mon_jeu</p>
<p>Si vous n'avez pas de nom de domaine, vous pouvez utiliser celui de github
com.github.votre_identifiant_github.votre_jeu</p>
<p>Donc ici il faut faire une création de branche de ce nom complet</p>
<pre><code>cd flathub
git checkout -b com.github.votre_identifiant_github.votre_jeu</code></pre>
<p>j'utiliserais pour y faire réference dans cet article com.domain.votre_jeu</p>
<h4>Créer la fiche d'identité Flathub</h4>
<p>Vous allez créer ici 2 fichiers flathub.json et com.domain.votre_jeu.yml</p>
<pre><code>touch flathub.json
touch com.domain.votre_jeu.yml</code></pre>
<p>Contenu de flathub.json</p>
<pre><code>{
  "only-arches": ["x86_64"]
}</code></pre>
<p>Contenu de com.domain.votre_jeu.yml</p>
<pre><code>id: com.domain.votre_jeu.yml
runtime: org.freedesktop.Platform
runtime-version: "23.08"
sdk: org.freedesktop.Sdk
command: votre_jeu
finish-args:
  - --share=ipc
  - --socket=pulseaudio
  - --socket=x11
  - --device=dri
  - --persist=.local/share/godot/app_userdata/votre_jeu

modules:
  - name: VotreJeu
    buildsystem: simple
    sources:
      - type: git
        url: https://github.com/votre_identifiant_github/votre_jeu/
        commit: identifiant_du_dernier_commit

    build-commands:
      - install -Dm755 export/linux/votre_jeu.x86_64 $FLATPAK_DEST/bin/votre_jeu.x86_64
      - install -Dm555 export/linux/votre_jeu.pck $FLATPAK_DEST/bin/votre_jeu.pck
      - install -Dm644 export/linux/flatpack/512x512.png $FLATPAK_DEST/share/icons/hicolor/512x512/apps/com.domain.votre_jeu.png
      - install -Dm644 export/linux/flatpack/com.domain.votre_jeu.desktop $FLATPAK_DEST/share/applications/com.domain.votre_jeu.desktop
      - install -Dm644 export/linux/flatpack/com.domain.votre_jeu.appdata.xml $FLATPAK_DEST/share/metainfo/com.domain.votre_jeu.appdata.xml      </code></pre>
<p>Ici on indiquer que l'on va récuperer notre jeu sur notre dépot github au dernier commit ID</p>
<p>Une fois la récupération de nos sources faite, on va installer le fichier présent sur notre github </p>
<ul>
<li>le fichier du jeu .x86_64 et .pck dans l'espace où sont stoqués les binaries flathub</li>
<li>l'icone du jeu en 512x512</li>
<li>le fichier desktop, qui est l'identité de notre jeu, une fois installé chez l'utilisateur (dans quel menu..)</li>
<li>le fichier appdata qui stoque d'autres informations come le changelog, les screenshots..</li>
</ul>
<p>Vous pouvez commit, push (sur votre branch com.github.votre_identifiant_github.votre_jeu )</p>
<p>Ensuite, rendez vous sur <a href="https://github.com/flathub/flathub/branches">https://github.com/flathub/flathub/branches</a></p>
<p>et faites un pull request de votre branche de jeu vers &quot;new-pr&quot;</p>
<p>S'ensuite une phase de validation de votre envoi, avec souvent un chat avec les mainteneurs du projet</p>
<p>Une fois que tout est validé, flathub devrait créer une branche de votre jeu sur son dépôt</p>
<h4>Conclusion</h4>
<p>Comme vous avez pu le voir, c'est ici très simple de packager votre jeu sur Flathub</p>
<p>C'est impressionnant de voir la mécanique totalement automatisé de gestion de nouveaux paquets, les builds...</p>                </div>


            </div>
        </div>
    </div>

</div>
    </div>

  </div>



  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <!-- Compiled and minified JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

  <script>
    (function($) {
      $(function() {
        $('.sidenav').sidenav();
      }); // end of document ready
    })(jQuery);
  </script>


</body>

</html>